<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Machine Generated CC</title>
</head>
<body style="font-family: verdana; font-size: 10pt">
    <h3>Machine Generated Closed Captions</h3>
    <ul>
        <li>Caption file format: <a href="http://willzhan12.cloudapp.net/smoothstreaming/progressive/Build/Build2014Keynote.mp4.smi" target="_blank">SAMI</a> and <a href="http://willzhan12.cloudapp.net/smoothstreaming/progressive/Build/Build2014Keynote.mp4.ttml" target="_blank">TTML</a></li>
        <li><a href="http://willzhan12.cloudapp.net/smoothstreaming/progressive/Build/Build2014Keynote.mp4.kw.xml" target="_blank">Key word file generated</a></li>
        <li>Player: HTML5</li>
        <li>Caption displayed via <a href="http://www.w3.org/TR/2013/WD-ttml10-sdp-us-20130103/" target="_blank">SDP-US</a></li>
    </ul>
    <div>
        Select video source: 
        <select id="selecturl" onchange="play();"></select> 
        <input type="checkbox" id="chkCC" value="Add CC Tracks" onclick="addRemoveCC();" checked="checked" /> Add CC Tracks
    </div>
    <div>
        <video id="videoElement" controls="controls" autoplay="autoplay" width="1000" poster="images/build2014.jpg"></video>
    </div>
    <p> 
        NOTE: Chrome does not support TTML but support WebVTT. <a href="DashPlayer.aspx">Here is the version</a> using WebVTT which works in both IE and Chrome. In addition, Chrome does not support multiple tracks (only a single track is available at a time).
    </p>
    <script>
        var data = [
                { 
                    url: "https://cnewscctest.blob.core.windows.net/asset-b3849298-9a30-45f1-b3bb-6f2031b26235/0803_CTM_Lewis_QandA_1101559_740.mp4?sv=2012-02-12&sr=c&si=0ac94a23-4d4e-4f72-b315-65492a4b0d93&sig=sv%2B%2ByoDTfittpvMH6IZx0VFXex5Jx%2BpzcDR1hZ0DNY8%3D&st=2016-08-26T20%3A04%3A20Z&se=2116-08-26T20%3A04%3A20Z",                                                                                       
                    text: "CTM Lewis Q and A", 
                    src: "Assets/CTM-Lewis-QA.vtt",                                                                                   
                    id: "video3", 
                    label: "Closed Captions Generated by Azure Media Services Indexer", 
                    default: true 
                 },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/Build/Build2014Keynote.mp4",                                                                                     text: "Build 2014: Keynote Session (2:45)",   src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/Build/Build2014Keynote.mp4.ttml",                                                                                 id: "ID13", label: "CC Generated by MAVIS", default: true },
                 //{ url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/emc/EMC.mp4",                                                                                                    text: "EMC: Interviewing EMEA Executives",    src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/EMC/emc.mp4.ttml",                                                                                                id: "ID01", label: "CC Generated by MAVIS", default: true },
                 //{ url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/tvg/TVG_EVP_Greenberg_MCS_H264_2200kbps_AAC_und_ch2_128kbps.mp4",                                                text: "TVG: Executive VP Feedback",           src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/TVG/TVG_EVP_Greenberg_MCS.wmv.ttml",                                                                              id: "ID02", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/LYNC/LyncSkypeSizzleVideo750k.mp4",                                                                              text: "LYNC: Lync and Skype Sizzle Marketing",src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/LYNC/LyncSkypeSizzleVideo750k.mp4.ttml",                                                                          id: "ID03", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Intro/Office-Mix-Intro-6-28-2014-7-48-28-AM.mp4",                                                 text: "MIX: Office Mix Introduction",         src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Intro/Office-Mix-Intro-6-28-2014-7-48-28-AM.ttml",                                                 id: "ID04", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Creating-a-Basic-Recording/Office-Mix-Creating-a-Basic-Recording-6-28-2014-7-49-31-AM.mp4",       text: "MIX: Create a Basic Recording",        src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Creating-a-Basic-Recording/Office-Mix-Creating-a-Basic-Recording-6-28-2014-7-49-31-AM.ttml",       id: "ID05", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Inserting-a-Quiz/Office-Mix-Inserting-a-Quiz-6-28-2014-7-50-13-AM.mp4",                           text: "MIX: Insert a Quiz",                   src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Inserting-a-Quiz/Office-Mix-Inserting-a-Quiz-6-28-2014-7-50-13-AM.ttml",                           id: "ID06", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Recording-a-Screen-Capture/Office-Mix-Recording-a-Screen-Capture-6-28-2014-7-51-09-AM.mp4",       text: "MIX: Record a Screen Capture",         src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Recording-a-Screen-Capture/Office-Mix-Recording-a-Screen-Capture-6-28-2014-7-51-09-AM.ttml",       id: "ID07", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Recording-Quality-Audio-Video/Office-Mix-Recording-Quality-Audio-Video-6-28-2014-7-52-24-AM.mp4", text: "MIX: Record High Quality Audio Video", src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Recording-Quality-Audio-Video/Office-Mix-Recording-Quality-Audio-Video-6-28-2014-7-52-24-AM.ttml", id: "ID08", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Upload-Share/Office-Mix-Upload-Share-6-28-2014-7-51-44-AM.mp4",                                   text: "MIX: Upload and Share",                src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/MIX/Office-Mix-Upload-Share/Office-Mix-Upload-Share-6-28-2014-7-51-44-AM.ttml",                                   id: "ID09", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/WP81/Delights/WP81Delights.mp4",                                                                                 text: "WP81: Windows Phone 8.1 Delights",     src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/WP81/Delights/WP81Delights.mp4.ttml",                                                                             id: "ID10", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/WP81/GetPersonal/WP81GetPersonal.mp4",                                                                           text: "WP81: Get Personal with WP 8.1",       src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/WP81/GetPersonal/WP81GetPersonal.mp4.ttml",                                                                       id: "ID11", label: "CC Generated by MAVIS", default: true },
                 { url: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/WP81/Win81/WP81Win81.mp4",                                                                                       text: "WP81: WP 8.1 and Windows 8.1",         src: "http://willzhan12.cloudapp.net/smoothstreaming/progressive/WP81/Win81/WP81Win81.mp4.ttml",                                                                                   id: "ID12", label: "CC Generated by MAVIS", default: true }
    ];

    loadSelect();
    play();

    function play() {
        var select = document.getElementById('selecturl');
        var sourceUrl = select.options[select.selectedIndex].value;
        if (sourceUrl.length > 5) {
            //set CC track
            addRemoveCC();
            
            var video = document.getElementById('videoElement');
            video.src = sourceUrl;
            video.play();
        }
        else {
            window.alert("Select a valid media source URL.")
        }
    }

    function addRemoveCC()
    {
        var track;
        var video = document.getElementById("videoElement");
        var checkbox = document.getElementById("chkCC");

        //clean CC track
        for (var i = 0; i < data.length; i++) {
            track = document.getElementById(data[i].id);
            if (track != null)
                video.removeChild(track);
        }

        //add selected CC track
        if (checkbox.checked)
        {
            var select = document.getElementById('selecturl');
            var sourceUrl = select.options[select.selectedIndex].value;

            for (var i = 0; i < data.length; i++) {
                if (data[i].url == sourceUrl) {
                    track = document.createElement("track");
                    track.src = data[i].src;
                    track.label = data[i].label;
                    track.default = data[i].default;
                    track.id = data[i].id;
                    video.appendChild(track);
                    break;
                }
            }
        }
    }

    function loadSelect() {
        var select = document.getElementById('selecturl');
        for (var i = 0; i < data.length; i++) {
            select.options[select.options.length] = new Option(data[i].text, data[i].url);
        }
    }
    </script>
</body>
</html>